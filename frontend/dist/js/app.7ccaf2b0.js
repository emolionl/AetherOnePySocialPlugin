(function(){"use strict";var e={8705:function(e,s,t){var l=t(5130),i=t(6768);const r={id:"app"};function o(e,s,t,l,o,a){const n=(0,i.g2)("TopNav"),d=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.bF)(n,{avatarUrl:"https://randomuser.me/api/portraits/men/1.jpg"}),(0,i.bF)(d)])}t(4114);var a=t(4232);const n={class:"topnav"},d={class:"nav-center"},c={key:0,class:"badge badge-green"},u={class:"nav-right"},h={key:0,class:"dropdown-menu"},k={class:"dropdown-email"};function y(e,s,t,l,r,o){const y=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("nav",n,[s[16]||(s[16]=(0,i.Fv)('<div class="nav-left" data-v-571f6628><div class="logo" data-v-571f6628><svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-571f6628><circle cx="18" cy="18" r="18" fill="#b39ddb" data-v-571f6628></circle><circle cx="10" cy="18" r="4" fill="#fff" data-v-571f6628></circle><circle cx="26" cy="18" r="4" fill="#fff" data-v-571f6628></circle><circle cx="18" cy="10" r="4" fill="#fff" data-v-571f6628></circle><circle cx="18" cy="26" r="4" fill="#fff" data-v-571f6628></circle><line x1="14" y1="18" x2="18" y2="14" stroke="#b39ddb" stroke-width="2" data-v-571f6628></line><line x1="22" y1="18" x2="18" y2="14" stroke="#b39ddb" stroke-width="2" data-v-571f6628></line><line x1="14" y1="18" x2="18" y2="22" stroke="#b39ddb" stroke-width="2" data-v-571f6628></line><line x1="22" y1="18" x2="18" y2="22" stroke="#b39ddb" stroke-width="2" data-v-571f6628></line></svg></div></div>',1)),(0,i.Lk)("div",d,[(0,i.bF)(y,{to:"/home",class:"nav-item active",style:{"text-decoration":"none",color:"inherit"}},{default:(0,i.k6)((()=>s[5]||(s[5]=[(0,i.Lk)("i",{class:"fas fa-home"},null,-1),(0,i.Lk)("span",null,"Home",-1)]))),_:1,__:[5]}),(0,i.bF)(y,{to:"/sessions",class:"nav-item",style:{"text-decoration":"none",color:"inherit"}},{default:(0,i.k6)((()=>s[6]||(s[6]=[(0,i.Lk)("i",{class:"fas fa-list"},null,-1),(0,i.Lk)("span",null,"My local Sessions",-1)]))),_:1,__:[6]}),(0,i.bF)(y,{to:"/analysis",class:"nav-item",style:{"text-decoration":"none",color:"inherit"}},{default:(0,i.k6)((()=>s[7]||(s[7]=[(0,i.Lk)("i",{class:"fas fa-chart-pie"},null,-1),(0,i.Lk)("span",null,"Shared Analysis",-1)]))),_:1,__:[7]}),(0,i.bF)(y,{to:"/keys",class:"nav-item",style:{"text-decoration":"none",color:"inherit"}},{default:(0,i.k6)((()=>s[8]||(s[8]=[(0,i.Lk)("i",{class:"fas fa-key"},null,-1),(0,i.Lk)("span",null,"Keys",-1)]))),_:1,__:[8]}),(0,i.Lk)("div",{class:"nav-item",onClick:s[0]||(s[0]=s=>e.$router.push("/servers")),style:{position:"relative"}},[s[10]||(s[10]=(0,i.Lk)("i",{class:"fas fa-server"},null,-1)),s[11]||(s[11]=(0,i.Lk)("span",null,"Servers",-1)),r.serverSelected?((0,i.uX)(),(0,i.CE)("span",c,s[9]||(s[9]=[(0,i.Lk)("i",{class:"fas fa-check"},null,-1)]))):(0,i.Q3)("",!0)]),s[12]||(s[12]=(0,i.Lk)("div",{class:"nav-item"},[(0,i.Lk)("i",{class:"fas fa-bell"}),(0,i.Lk)("span",null,"Notifications"),(0,i.Lk)("span",{class:"badge"},"3")],-1))]),(0,i.Lk)("div",u,[r.userEmail?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("span",{class:"avatar spiritual-avatar",onClick:s[1]||(s[1]=(...e)=>o.toggleDropdown&&o.toggleDropdown(...e))},s[13]||(s[13]=[(0,i.Fv)('<svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-571f6628><circle cx="18" cy="18" r="18" fill="#f5f3e7" data-v-571f6628></circle><g data-v-571f6628><path d="M18 7C19.5 12 27 13.5 27 18C27 22.5 19.5 24 18 29C16.5 24 9 22.5 9 18C9 13.5 16.5 12 18 7Z" fill="#b39ddb" data-v-571f6628></path><circle cx="18" cy="18" r="4" fill="#9575cd" data-v-571f6628></circle><path d="M18 12V24" stroke="#9575cd" stroke-width="1.5" stroke-linecap="round" data-v-571f6628></path><path d="M12 18H24" stroke="#9575cd" stroke-width="1.5" stroke-linecap="round" data-v-571f6628></path></g></svg>',1)])),(0,i.Lk)("span",{class:"me-label",onClick:s[2]||(s[2]=(...e)=>o.toggleDropdown&&o.toggleDropdown(...e)),style:{cursor:"pointer"}},s[14]||(s[14]=[(0,i.eW)("Me "),(0,i.Lk)("i",{class:"fas fa-caret-down"},null,-1)])),r.dropdownOpen?((0,i.uX)(),(0,i.CE)("div",h,[(0,i.Lk)("div",k,(0,a.v_)(r.userEmail),1),(0,i.bF)(y,{to:"/settings",class:"dropdown-item"},{default:(0,i.k6)((()=>s[15]||(s[15]=[(0,i.eW)("Settings")]))),_:1,__:[15]}),(0,i.Lk)("div",{class:"dropdown-item",onClick:s[3]||(s[3]=(...e)=>o.logout&&o.logout(...e))},"Logout")])):(0,i.Q3)("",!0)],64)):((0,i.uX)(),(0,i.CE)("button",{key:1,class:"login-btn",onClick:s[4]||(s[4]=s=>e.$router.push("/auth"))},"Login"))])])}var v={name:"TopNav",props:{avatarUrl:{type:String,default:"https://randomuser.me/api/portraits/men/1.jpg"}},data(){return{serverSelected:!1,userEmail:"",dropdownOpen:!1}},mounted(){this.checkServer(),this.$watch((()=>this.$route.fullPath),this.checkServer),document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{checkServer(){this.serverSelected=!!localStorage.getItem("selectedServerId");const e=localStorage.getItem("selectedServerId"),s=JSON.parse(localStorage.getItem("userTokens")||"{}"),t=JSON.parse(localStorage.getItem("userEmails")||"{}");this.userEmail=e&&s[e]&&t[e]?t[e]:""},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},handleClickOutside(e){this.$el.contains(e.target)||(this.dropdownOpen=!1)},logout(){const e=localStorage.getItem("selectedServerId");let s=JSON.parse(localStorage.getItem("userTokens")||"{}"),t=JSON.parse(localStorage.getItem("userEmails")||"{}");e&&(delete s[e],delete t[e],localStorage.setItem("userTokens",JSON.stringify(s)),localStorage.setItem("userEmails",JSON.stringify(t))),this.dropdownOpen=!1,this.$router.push("/auth")}}},p=t(1241);const g=(0,p.A)(v,[["render",y],["__scopeId","data-v-571f6628"]]);var m=g,L={name:"App",components:{TopNav:m}};const f=(0,p.A)(L,[["render",o]]);var b=f,C=t(1387);const E={class:"home-view"};function S(e,s,t,l,r,o){return(0,i.uX)(),(0,i.CE)("div",E,s[0]||(s[0]=[(0,i.Lk)("div",{class:"instructions"},[(0,i.Lk)("h2",null,"Welcome to AetherOnePy Social!"),(0,i.Lk)("ul",null,[(0,i.Lk)("li",null,"Use the navigation menu to access sessions, share analyses, and manage your keys."),(0,i.Lk)("li",null,"To get started, select a server and log in or register."),(0,i.Lk)("li",null,"After logging in, you can view and share your analysis sessions with others."),(0,i.Lk)("li",null,"Visit the Analysis page to see all your shared analyses by key")])],-1),(0,i.Lk)("div",{class:"video-container"},[(0,i.Lk)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/16EuKQ7Nku0",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""})],-1)]))}var _={name:"HelloWorld"};const w=(0,p.A)(_,[["render",S],["__scopeId","data-v-040325ff"]]);var K=w;const X={class:"server-setup"},I={key:0,class:"user-email"},D={key:1},T={key:2},M={key:0},x={key:0,class:"error"},F={key:1},A={key:1},O=["value"],W={class:"servers-table"},U=["onClick"],$=["onClick"],j={key:0,style:{color:"#2ecc40","font-weight":"bold","margin-left":"8px"}},N={key:2,class:"error"};function Q(e,s,t,r,o,n){return(0,i.uX)(),(0,i.CE)("div",X,[o.userEmail?((0,i.uX)(),(0,i.CE)("div",I,"Logged in as: "+(0,a.v_)(o.userEmail),1)):(0,i.Q3)("",!0),s[36]||(s[36]=(0,i.Lk)("h2",null,"Server Setup",-1)),o.loading?((0,i.uX)(),(0,i.CE)("div",D,"Loading...")):((0,i.uX)(),(0,i.CE)("div",T,[0===o.servers.length?((0,i.uX)(),(0,i.CE)("div",M,[(0,i.Lk)("form",{onSubmit:s[2]||(s[2]=(0,l.D$)(((...e)=>n.addServer&&n.addServer(...e)),["prevent"]))},[(0,i.Lk)("label",null,[s[12]||(s[12]=(0,i.eW)("Server URL:")),s[13]||(s[13]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>o.url=e),required:"",placeholder:"https://example.com"},null,512),[[l.Jo,o.url]])]),s[16]||(s[16]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("label",null,[s[14]||(s[14]=(0,i.eW)("Description:")),s[15]||(s[15]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>o.description=e),placeholder:"Description (optional)"},null,512),[[l.Jo,o.description]])]),s[17]||(s[17]=(0,i.Lk)("br",null,null,-1)),s[18]||(s[18]=(0,i.Lk)("button",{type:"submit"},"Add Server",-1))],32),o.error?((0,i.uX)(),(0,i.CE)("div",x,(0,a.v_)(o.error),1)):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.CE)("div",F,[o.editId?((0,i.uX)(),(0,i.CE)("form",{key:0,onSubmit:s[6]||(s[6]=(0,l.D$)(((...e)=>n.saveEdit&&n.saveEdit(...e)),["prevent"]))},[(0,i.Lk)("label",null,[s[19]||(s[19]=(0,i.eW)("Edit URL:")),s[20]||(s[20]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>o.editUrl=e),required:""},null,512),[[l.Jo,o.editUrl]])]),s[23]||(s[23]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("label",null,[s[21]||(s[21]=(0,i.eW)("Edit Description:")),s[22]||(s[22]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>o.editDescription=e)},null,512),[[l.Jo,o.editDescription]])]),s[24]||(s[24]=(0,i.Lk)("br",null,null,-1)),s[25]||(s[25]=(0,i.Lk)("button",{type:"submit"},"Save",-1)),(0,i.Lk)("button",{type:"button",onClick:s[5]||(s[5]=(...e)=>n.cancelEdit&&n.cancelEdit(...e))},"Cancel")],32)):((0,i.uX)(),(0,i.CE)("div",A,[s[26]||(s[26]=(0,i.Lk)("label",null,"Select a server:",-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":s[7]||(s[7]=e=>o.selectedServerId=e)},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.servers,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,a.v_)(e.url)+" ("+(0,a.v_)(e.description)+")",9,O)))),128))],512),[[l.u1,o.selectedServerId]]),(0,i.Lk)("button",{onClick:s[8]||(s[8]=(...e)=>n.selectServer&&n.selectServer(...e))},"Continue")])),s[35]||(s[35]=(0,i.Lk)("h3",{style:{"margin-top":"2em"}},"All Servers",-1)),(0,i.Lk)("table",W,[s[27]||(s[27]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"URL"),(0,i.Lk)("th",null,"Description"),(0,i.Lk)("th",null,"Actions")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.servers,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id,class:(0,a.C4)({selected:e.selected})},[(0,i.Lk)("td",null,(0,a.v_)(e.url),1),(0,i.Lk)("td",null,(0,a.v_)(e.description),1),(0,i.Lk)("td",null,[(0,i.Lk)("button",{onClick:s=>n.startEdit(e)},"Edit",8,U),(0,i.Lk)("button",{onClick:s=>n.deleteServer(e.id)},"Delete",8,$),e.selected?((0,i.uX)(),(0,i.CE)("span",j,"(Selected)")):(0,i.Q3)("",!0)])],2)))),128))])]),(0,i.Lk)("form",{onSubmit:s[11]||(s[11]=(0,l.D$)(((...e)=>n.addServer&&n.addServer(...e)),["prevent"])),style:{"margin-top":"2em"}},[(0,i.Lk)("label",null,[s[28]||(s[28]=(0,i.eW)("New Server URL:")),s[29]||(s[29]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[9]||(s[9]=e=>o.url=e),required:"",placeholder:"https://example.com"},null,512),[[l.Jo,o.url]])]),s[32]||(s[32]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("label",null,[s[30]||(s[30]=(0,i.eW)("New Description:")),s[31]||(s[31]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[10]||(s[10]=e=>o.description=e),placeholder:"Description (optional)"},null,512),[[l.Jo,o.description]])]),s[33]||(s[33]=(0,i.Lk)("br",null,null,-1)),s[34]||(s[34]=(0,i.Lk)("button",{type:"submit"},"Add Server",-1))],32),o.error?((0,i.uX)(),(0,i.CE)("div",N,(0,a.v_)(o.error),1)):(0,i.Q3)("",!0)]))]))])}t(8111),t(116),t(1701);const J="/aetheronepysocialplugin";var V={name:"ServerSetup",data(){return{servers:[],loading:!0,url:"",description:"",error:"",selectedServerId:null,editId:null,editUrl:"",editDescription:"",userEmail:""}},mounted(){this.fetchServers(),this.updateUserEmail()},watch:{selectedServerId(){this.updateUserEmail()}},methods:{fetchServers(){this.loading=!0,fetch(`${J}/server`).then((e=>e.json())).then((e=>{const s=localStorage.getItem("selectedServerId");this.servers=(e.servers||[]).map((e=>({...e,selected:s&&String(e.id)===String(s)}))),this.loading=!1,this.servers.length>0&&(s&&this.servers.find((e=>String(e.id)===String(s)))?this.selectedServerId=Number(s):this.selectedServerId=this.servers[0].id,this.updateUserEmail())}))},addServer(){this.error="",fetch(`${J}/server`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:this.url,description:this.description})}).then((e=>e.json())).then((e=>{"success"===e.status?(this.url="",this.description="",this.fetchServers()):this.error=e.message||"Failed to add server."})).catch((()=>{this.error="Failed to add server."}))},selectServer(){this.selectedServerId&&(localStorage.setItem("selectedServerId",this.selectedServerId),this.updateUserEmail(),this.$router.push("/home"))},startEdit(e){this.editId=e.id,this.editUrl=e.url,this.editDescription=e.description},cancelEdit(){this.editId=null,this.editUrl="",this.editDescription=""},saveEdit(){this.error="Edit not implemented (backend needed)"},deleteServer(e){confirm("Are you sure you want to delete this server?")&&fetch(`${J}/server/${e}`,{method:"DELETE"}).then((e=>e.json())).then((s=>{"success"===s.status?(String(e)===String(localStorage.getItem("selectedServerId"))&&localStorage.removeItem("selectedServerId"),this.fetchServers()):this.error=s.message||"Failed to delete server."})).catch((()=>{this.error="Failed to delete server."}))},updateUserEmail(){const e=JSON.parse(localStorage.getItem("userEmails")||"{}");this.userEmail=this.selectedServerId&&e[this.selectedServerId]?e[this.selectedServerId]:""}}};const P=(0,p.A)(V,[["render",Q],["__scopeId","data-v-f3a088bc"]]);var R=P;const q={class:"auth-page"},H={key:0},G={key:1},Y={key:0},B=["disabled"],Z=["disabled"],z=["disabled"],ee=["disabled"],se={key:0,class:"loading-spinner"},te={key:1},le={key:2,class:"error"},ie={class:"switch-mode"},re={key:0},oe={key:1};function ae(e,s,t,r,o,n){return(0,i.uX)(),(0,i.CE)("div",q,["login"===o.mode?((0,i.uX)(),(0,i.CE)("h2",H,"Login")):((0,i.uX)(),(0,i.CE)("h2",G,"Register")),(0,i.Lk)("form",{onSubmit:s[3]||(s[3]=(0,l.D$)((e=>"login"===o.mode?n.login():n.register()),["prevent"]))},["register"===o.mode?((0,i.uX)(),(0,i.CE)("div",Y,[(0,i.Lk)("label",null,[s[6]||(s[6]=(0,i.eW)("Username:")),s[7]||(s[7]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>o.username=e),required:"",disabled:o.loading},null,8,B),[[l.Jo,o.username]])]),s[8]||(s[8]=(0,i.Lk)("br",null,null,-1))])):(0,i.Q3)("",!0),(0,i.Lk)("label",null,[s[9]||(s[9]=(0,i.eW)("Email:")),s[10]||(s[10]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>o.email=e),type:"email",required:"",disabled:o.loading},null,8,Z),[[l.Jo,o.email]])]),s[13]||(s[13]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("label",null,[s[11]||(s[11]=(0,i.eW)("Password:")),s[12]||(s[12]=(0,i.Lk)("br",null,null,-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>o.password=e),type:"password",required:"",disabled:o.loading},null,8,z),[[l.Jo,o.password]])]),s[14]||(s[14]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("button",{type:"submit",disabled:o.loading},[o.loading?((0,i.uX)(),(0,i.CE)("span",se)):((0,i.uX)(),(0,i.CE)("span",te,(0,a.v_)("login"===o.mode?"Login":"Register"),1))],8,ee)],32),o.error?((0,i.uX)(),(0,i.CE)("div",le,(0,a.v_)(o.error),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",ie,["login"===o.mode?((0,i.uX)(),(0,i.CE)("span",re,[s[15]||(s[15]=(0,i.eW)("Need an account? ")),(0,i.Lk)("a",{href:"#",onClick:s[4]||(s[4]=(0,l.D$)((e=>o.mode="register"),["prevent"])),class:(0,a.C4)({disabled:o.loading})},"Register",2)])):((0,i.uX)(),(0,i.CE)("span",oe,[s[16]||(s[16]=(0,i.eW)("Already have an account? ")),(0,i.Lk)("a",{href:"#",onClick:s[5]||(s[5]=(0,l.D$)((e=>o.mode="login"),["prevent"])),class:(0,a.C4)({disabled:o.loading})},"Login",2)]))])])}const ne="/aetheronepysocialplugin";var de={name:"AuthForm",data(){return{mode:"login",username:"",email:"",password:"",error:"",loading:!1}},methods:{login(){this.error="",this.loading=!0,fetch(`${ne}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.email,password:this.password})}).then((e=>e.json())).then((e=>{e.access_token||e.token?(this.saveToken(e.access_token||e.token,this.email),this.$router.push("/home")):this.error=e.message||"Login failed."})).catch((()=>{this.error="Login failed."})).finally((()=>{this.loading=!1}))},register(){this.error="",this.loading=!0,fetch(`${ne}/api/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,email:this.email,password:this.password})}).then((e=>e.json())).then((e=>{if("success"!==e.status||!e.external_response||!e.external_response.access_token)throw new Error(e.message||"Registration failed.");this.saveToken(e.external_response.access_token,this.email),this.$router.push("/home")})).catch((e=>{this.error=e.message||"Registration failed."})).finally((()=>{this.loading=!1}))},saveToken(e,s){const t=localStorage.getItem("selectedServerId");let l=JSON.parse(localStorage.getItem("userTokens")||"{}");l[t]=e,localStorage.setItem("userTokens",JSON.stringify(l));let i=JSON.parse(localStorage.getItem("userEmails")||"{}");i[t]=s,localStorage.setItem("userEmails",JSON.stringify(i))}}};const ce=(0,p.A)(de,[["render",ae],["__scopeId","data-v-6f7d209a"]]);var ue=ce;const he={class:"sessions-view"},ke={key:0},ye={key:1,class:"error"},ve={key:2},pe={class:"session-info"},ge=["onClick"],me={class:"modal"},Le={class:"modal-content"},fe={key:0,class:"existing-key-select"},be={class:"timeline"},Ce={class:"timeline-msg"},Ee={key:0,class:"loading-indicator"},Se={key:1,class:"loading-indicator"},_e={class:"modal-actions"},we=["disabled"],Ke=["disabled"];function Xe(e,s,t,r,o,n){return(0,i.uX)(),(0,i.CE)("div",he,[s[20]||(s[20]=(0,i.Lk)("h1",null,"Sessions",-1)),o.loading?((0,i.uX)(),(0,i.CE)("div",ke,"Loading sessions...")):o.error?((0,i.uX)(),(0,i.CE)("div",ye,(0,a.v_)(o.error),1)):((0,i.uX)(),(0,i.CE)("ul",ve,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.sessions,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.id,class:"session-item"},[(0,i.Lk)("div",pe,[(0,i.Lk)("div",null,[s[7]||(s[7]=(0,i.Lk)("strong",null,"ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.id),1),s[8]||(s[8]=(0,i.Lk)("br",null,null,-1)),s[9]||(s[9]=(0,i.Lk)("strong",null,"Description:",-1)),(0,i.eW)(" "+(0,a.v_)(e.description),1),s[10]||(s[10]=(0,i.Lk)("br",null,null,-1)),s[11]||(s[11]=(0,i.Lk)("strong",null,"Intention:",-1)),(0,i.eW)(" "+(0,a.v_)(e.intention),1),s[12]||(s[12]=(0,i.Lk)("br",null,null,-1)),s[13]||(s[13]=(0,i.Lk)("strong",null,"Created:",-1)),(0,i.eW)(" "+(0,a.v_)(e.created),1),s[14]||(s[14]=(0,i.Lk)("br",null,null,-1))]),(0,i.Lk)("button",{class:"share-btn",onClick:s=>n.openShareModal(e)},"Share",8,ge)]),s[15]||(s[15]=(0,i.Lk)("hr",null,null,-1))])))),128))])),o.showModal?((0,i.uX)(),(0,i.CE)("div",{key:3,class:"modal-overlay",onClick:s[6]||(s[6]=(0,l.D$)(((...e)=>n.closeModal&&n.closeModal(...e)),["self"]))},[(0,i.Lk)("div",me,[(0,i.Lk)("h2",null,"Share Session (ID: "+(0,a.v_)(o.selectedSession?.id)+")",1),(0,i.Lk)("div",Le,[(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"radio",value:"new","onUpdate:modelValue":s[0]||(s[0]=e=>o.shareMode=e)},null,512),[[l.XL,o.shareMode]]),s[16]||(s[16]=(0,i.eW)(" Create new key "))]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"radio",value:"existing","onUpdate:modelValue":s[1]||(s[1]=e=>o.shareMode=e)},null,512),[[l.XL,o.shareMode]]),s[17]||(s[17]=(0,i.eW)(" Use existing key "))]),"existing"===o.shareMode?((0,i.uX)(),(0,i.CE)("div",fe,[s[18]||(s[18]=(0,i.Lk)("label",{for:"existingKey"},"Enter Key:",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>o.selectedKey=e),id:"existingKey",type:"text",placeholder:"Enter or paste session key"},null,512),[[l.Jo,o.selectedKey]])])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",be,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.timeline,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:(0,a.C4)(["timeline-item",e.type])},[s[19]||(s[19]=(0,i.Lk)("span",{class:"timeline-dot"},null,-1)),(0,i.Lk)("span",Ce,(0,a.v_)(e.text),1)],2)))),128))]),o.loading?((0,i.uX)(),(0,i.CE)("div",Ee,"Processing...")):(0,i.Q3)("",!0),o.shareLoading?((0,i.uX)(),(0,i.CE)("div",Se,"Processing...")):(0,i.Q3)("",!0),(0,i.Lk)("div",_e,[o.shareComplete?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:s[3]||(s[3]=(...e)=>n.submitShare&&n.submitShare(...e)),disabled:"existing"===o.shareMode&&!o.selectedKey||o.shareLoading},"Submit",8,we)),(0,i.Lk)("button",{onClick:s[4]||(s[4]=(...e)=>n.closeModal&&n.closeModal(...e)),disabled:o.shareLoading||o.shareComplete},"Cancel",8,Ke),o.shareComplete?((0,i.uX)(),(0,i.CE)("button",{key:1,onClick:s[5]||(s[5]=(...e)=>n.goToAnalysis&&n.goToAnalysis(...e)),class:"go-analysis-btn"},"Go to Analysis")):(0,i.Q3)("",!0)])])])):(0,i.Q3)("",!0)])}var Ie={name:"SessionsView",data(){return{sessions:[],loading:!0,error:"",showModal:!1,selectedSession:null,shareMode:"new",keys:[],selectedKey:"",timeline:[],autoCloseTimeout:null,shareComplete:!1,analysisUrl:"/analysis",shareLoading:!1}},mounted(){this.fetchSessions()},methods:{fetchSessions(){fetch("/aetheronepysocialplugin/sessions").then((e=>e.json())).then((e=>{this.sessions=e.sessions||[],this.loading=!1})).catch((()=>{this.error="Failed to load sessions.",this.loading=!1}))},openShareModal(e){this.selectedSession=e,this.showModal=!0,this.shareMode="new",this.selectedKey="",this.keys=[],this.timeline=[],this.autoCloseTimeout=null,this.shareComplete=!1,fetch(`/aetheronepysocialplugin/key?session_id=${e.id}`).then((e=>e.json())).then((e=>{this.keys=e.keys||[]})).catch((()=>{this.keys=[]}))},closeModal(){this.showModal=!1,this.selectedSession=null,this.shareMode="new",this.selectedKey="",this.keys=[],this.timeline=[],this.shareComplete=!1,this.autoCloseTimeout&&(clearTimeout(this.autoCloseTimeout),this.autoCloseTimeout=null)},addTimeline(e,s="info"){this.timeline.push({text:e,type:s}),console.log(`[${s.toUpperCase()}] ${e}`)},submitShare(){this.timeline=[],this.shareComplete=!1,this.shareLoading=!0,"new"===this.shareMode?(this.addTimeline("Creating new key..."),fetch("/aetheronepysocialplugin/key",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({local_session_id:this.selectedSession.id})}).then((e=>e.json())).then((e=>{if(("success"===e.status||"exists"===e.status)&&e.local&&e.local.key){const s=e.local.key;"exists"===e.status?this.addTimeline("Key already exists for this session. Using existing key: "+s,"info"):this.addTimeline("Key created: "+s,"success"),this.addTimeline("Fetching user info..."),fetch("/aetheronepysocialplugin/user").then((e=>e.json())).then((e=>{const t=e.server_user_id;this.addTimeline("User info loaded (server_user_id: "+t+")","success");const l=String(window.navigator.userAgent||"browser");this.addTimeline("Sharing analysis to server..."),fetch("/aetheronepysocialplugin/analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:this.selectedSession.id,server_user_id:t,key:s,machine_id:l})}).then((e=>e.json())).then((e=>{console.log("analysisData",e),console.log("analysisData.status:",e.status),e.status&&"success"===e.status.toLowerCase()?(this.addTimeline(e.message||"Analysis shared successfully!","success"),this.shareComplete=!0):(this.addTimeline("Failed to share analysis: "+(e.message||e.error||"Unknown error"),"error"),this.shareComplete=!0),this.shareLoading=!1})).catch((()=>{this.addTimeline("Failed to share analysis due to network error.","error"),this.shareComplete=!0,this.shareLoading=!1}))})).catch((()=>{this.addTimeline("Failed to get user info for sharing analysis.","error"),this.shareComplete=!0,this.shareLoading=!1}))}else this.addTimeline("Failed to create key: "+(e.message||"Unknown error"),"error"),this.shareComplete=!0,this.shareLoading=!1})).catch((()=>{this.addTimeline("Failed to create key due to network error.","error"),this.shareComplete=!0,this.shareLoading=!1}))):(this.addTimeline("Checking if key exists..."),fetch(`/aetheronepysocialplugin/check_key_exists/${this.selectedKey}`).then((e=>e.json())).then((e=>{e.exists?(this.addTimeline("Key exists. Proceeding to share..."),fetch("/aetheronepysocialplugin/user").then((e=>e.json())).then((e=>{const s=e.server_user_id;this.addTimeline("User info loaded (server_user_id: "+s+")","success");const t=String(window.navigator.userAgent||"browser");this.addTimeline("Sharing analysis to server..."),fetch("/aetheronepysocialplugin/analysis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:this.selectedSession.id,server_user_id:s,key:this.selectedKey,machine_id:t})}).then((e=>e.json())).then((e=>{e.status&&"success"===e.status.toLowerCase()?(this.addTimeline(e.message||"Analysis shared successfully!","success"),this.shareComplete=!0):(this.addTimeline("Failed to share analysis: "+(e.message||e.error||"Unknown error"),"error"),this.shareComplete=!0),this.shareLoading=!1})).catch((()=>{this.addTimeline("Failed to share analysis due to network error.","error"),this.shareComplete=!0,this.shareLoading=!1}))})).catch((()=>{this.addTimeline("Failed to get user info for sharing analysis.","error"),this.shareComplete=!0,this.shareLoading=!1}))):(e.explanation&&e.explanation.includes("exists but has no associated sessions")?(this.addTimeline("Key exists but has no associated sessions.","error"),this.addTimeline(e.explanation,"info")):(this.addTimeline("Key does not exist: "+(e.message||"No sessions found for this key."),"error"),e.explanation&&this.addTimeline(e.explanation,"error")),this.shareComplete=!0,this.shareLoading=!1)})).catch((()=>{this.addTimeline("Failed to check if key exists due to network error.","error"),this.shareComplete=!0,this.shareLoading=!1})))},goToAnalysis(){this.closeModal(),this.$router.push("/analysis")}}};const De=(0,p.A)(Ie,[["render",Xe],["__scopeId","data-v-5e20b10e"]]);var Te=De;const Me={class:"analysis-view"},xe={class:"breadcrumb-nav"},Fe={class:"breadcrumb"},Ae={key:0},Oe={key:1,class:"error"},We={key:0},Ue={key:0},$e={key:1},je={key:2},Ne={key:2},Qe={key:0},Je={class:"key-lists"},Ve={class:"merged-block"},Pe={class:"key-row-flex"},Re={class:"key-details"},qe={key:0},He=["onClick"],Ge={key:2},Ye={class:"key-actions-right"},Be=["onClick"];function Ze(e,s,t,l,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",Me,[(0,i.Lk)("nav",xe,[(0,i.Lk)("ul",Fe,[(0,i.Lk)("li",null,[(0,i.bF)(n,{to:"/home"},{default:(0,i.k6)((()=>s[0]||(s[0]=[(0,i.eW)("Home")]))),_:1,__:[0]})]),s[1]||(s[1]=(0,i.Lk)("li",null,"Analysis",-1))])]),s[12]||(s[12]=(0,i.Lk)("h1",null,"Analysis",-1)),r.loadingKeys?((0,i.uX)(),(0,i.CE)("div",Ae,"Loading keys...")):r.error?((0,i.uX)(),(0,i.CE)("div",Oe,[(0,i.eW)((0,a.v_)(r.error)+" ",1),r.errorDetails?((0,i.uX)(),(0,i.CE)("div",We,[r.errorDetails.explanation?((0,i.uX)(),(0,i.CE)("div",Ue,"Explanation: "+(0,a.v_)(r.errorDetails.explanation),1)):(0,i.Q3)("",!0),r.errorDetails.searched_key?((0,i.uX)(),(0,i.CE)("div",$e,"Searched Key: "+(0,a.v_)(r.errorDetails.searched_key),1)):(0,i.Q3)("",!0),r.errorDetails.suggestions&&r.errorDetails.suggestions.length?((0,i.uX)(),(0,i.CE)("div",je,[s[2]||(s[2]=(0,i.Lk)("h4",null,"Suggestions:",-1)),(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.errorDetails.suggestions,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e},(0,a.v_)(e),1)))),128))])])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.CE)("div",Ne,[0===r.mergedKeys.length?((0,i.uX)(),(0,i.CE)("div",Qe,"No keys found for this user.")):(0,i.Q3)("",!0),(0,i.Lk)("div",Je,[(0,i.Lk)("div",Ve,[s[11]||(s[11]=(0,i.Lk)("h2",null,"All Keys (Merged)",-1)),(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.mergedKeys,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.key,class:"key-item"},[(0,i.Lk)("div",Pe,[(0,i.Lk)("div",Re,[(0,i.Lk)("div",null,[s[3]||(s[3]=(0,i.Lk)("strong",null,"Key:",-1)),(0,i.eW)(" "+(0,a.v_)(e.key),1)]),e.local?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",null,[s[4]||(s[4]=(0,i.Lk)("strong",null,"Local Key ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.local.id),1)]),(0,i.Lk)("div",null,[s[5]||(s[5]=(0,i.Lk)("strong",null,"Created:",-1)),(0,i.eW)(" "+(0,a.v_)(e.local.created_at),1)]),(0,i.Lk)("div",null,[s[6]||(s[6]=(0,i.Lk)("strong",null,"Session ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.local.session_id),1)])],64)):(0,i.Q3)("",!0),e.server?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",null,[s[7]||(s[7]=(0,i.Lk)("strong",null,"Server Key ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.id),1)]),(0,i.Lk)("div",null,[s[8]||(s[8]=(0,i.Lk)("strong",null,"My Key:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.my_key?"Yes":"No"),1)]),(0,i.Lk)("div",null,[s[9]||(s[9]=(0,i.Lk)("strong",null,"Server Session ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.session_id),1)]),e.server.local_session_id?((0,i.uX)(),(0,i.CE)("div",qe,[s[10]||(s[10]=(0,i.Lk)("strong",null,"Local Session ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.local_session_id),1)])):(0,i.Q3)("",!0)],64)):(0,i.Q3)("",!0),(0,i.Lk)("button",{onClick:s=>r.showMore[e.key]=!r.showMore[e.key]},(0,a.v_)(r.showMore[e.key]?"Hide":"View More"),9,He),r.showMore[e.key]?((0,i.uX)(),(0,i.CE)("pre",Ge,(0,a.v_)(e),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Ye,[(0,i.Lk)("button",{class:"view-analyses-btn",onClick:s=>o.goToAnalyses(e.key)},"View Analyses",8,Be)])])])))),128))])])])]))])}var ze={name:"AnalysisView",data(){return{localKeys:[],serverKeys:[],mergedKeys:[],loadingKeys:!0,error:"",errorDetails:null,userId:"",showMore:{}}},mounted(){this.fetchUserIdAndKeys()},methods:{fetchUserIdAndKeys(){fetch("/aetheronepysocialplugin/user").then((e=>e.json())).then((e=>(this.userId=e.server_user_id,fetch(`/aetheronepysocialplugin/key/${this.userId}`)))).then((e=>e.json())).then((e=>{this.localKeys=e.data&&e.data.local?e.data.local:[],this.serverKeys=e.data&&e.data.server?e.data.server:[];const s={};for(const t of this.localKeys)t.key&&(s[t.key]={key:t.key,local:t});for(const t of this.serverKeys)t.key&&(s[t.key]?s[t.key].server=t:s[t.key]={key:t.key,server:t});this.mergedKeys=Object.values(s),this.loadingKeys=!1})).catch((e=>{e&&e.error&&e.error.detail?(this.error=e.error.detail.message||"Failed to load keys.",this.errorDetails=e.error.detail):(this.error="Failed to load keys.",this.errorDetails=null),this.loadingKeys=!1}))},goToAnalyses(e){this.$router.push(`/analysis/${e}`)}}};const es=(0,p.A)(ze,[["render",Ze],["__scopeId","data-v-64f3fc51"]]);var ss=es;const ts={class:"analysis-list-view"},ls={class:"breadcrumb-nav"},is={class:"breadcrumb"},rs={key:0},os={key:1,class:"error"},as={key:2},ns={key:0},ds={key:1},cs={key:0};function us(e,s,t,l,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",ts,[(0,i.Lk)("nav",ls,[(0,i.Lk)("ul",is,[(0,i.Lk)("li",null,[(0,i.bF)(n,{to:"/home"},{default:(0,i.k6)((()=>s[0]||(s[0]=[(0,i.eW)("Home")]))),_:1,__:[0]})]),(0,i.Lk)("li",null,[(0,i.bF)(n,{to:"/analysis"},{default:(0,i.k6)((()=>s[1]||(s[1]=[(0,i.eW)("Analysis")]))),_:1,__:[1]})]),(0,i.Lk)("li",null,(0,a.v_)(o.shortKey),1)])]),(0,i.Lk)("h1",null,"Analyses for Key: "+(0,a.v_)(r.key),1),r.loading?((0,i.uX)(),(0,i.CE)("div",rs,"Loading analyses...")):r.error?((0,i.uX)(),(0,i.CE)("div",os,(0,a.v_)(r.error),1)):((0,i.uX)(),(0,i.CE)("div",as,[0===r.sessions.length?((0,i.uX)(),(0,i.CE)("div",ns,"No analyses found for this key.")):((0,i.uX)(),(0,i.CE)("div",ds,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.sessions,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"session-block"},[(0,i.Lk)("h2",null,"Session: "+(0,a.v_)(e.description)+" ("+(0,a.v_)(e.created)+")",1),(0,i.Lk)("div",null,[s[2]||(s[2]=(0,i.Lk)("strong",null,"Case:",-1)),(0,i.eW)(" "+(0,a.v_)(e.case?.name),1),s[3]||(s[3]=(0,i.Lk)("br",null,null,-1)),s[4]||(s[4]=(0,i.Lk)("strong",null,"Intention:",-1)),(0,i.eW)(" "+(0,a.v_)(e.intention),1)]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.analyses,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"analysis-block"},[(0,i.Lk)("h3",null,"Analysis ("+(0,a.v_)(e.created)+")",1),(0,i.Lk)("div",null,[s[5]||(s[5]=(0,i.Lk)("strong",null,"Catalog:",-1)),(0,i.eW)(" "+(0,a.v_)(e.catalog?.name),1),s[6]||(s[6]=(0,i.Lk)("br",null,null,-1)),s[7]||(s[7]=(0,i.Lk)("strong",null,"Target GV:",-1)),(0,i.eW)(" "+(0,a.v_)(e.target_gv),1)]),e.rate_analyses&&e.rate_analyses.length?((0,i.uX)(),(0,i.CE)("table",cs,[s[8]||(s[8]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Signature"),(0,i.Lk)("th",null,"Energetic Value"),(0,i.Lk)("th",null,"GV"),(0,i.Lk)("th",null,"Note")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.rate_analyses,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",null,(0,a.v_)(e.signature),1),(0,i.Lk)("td",null,(0,a.v_)(e.energetic_value),1),(0,i.Lk)("td",null,(0,a.v_)(e.gv),1),(0,i.Lk)("td",null,(0,a.v_)(e.note),1)])))),128))])])):(0,i.Q3)("",!0)])))),128))])))),128))]))]))])}var hs={name:"AnalysisListView",data(){return{key:this.$route.params.key,sessions:[],loading:!0,error:""}},computed:{shortKey(){return this.key?this.key.length>12?this.key.slice(0,6)+"..."+this.key.slice(-6):this.key:""}},mounted(){this.fetchAnalyses()},watch:{"$route.params.key"(e){this.key=e,this.fetchAnalyses()}},methods:{fetchAnalyses(){this.loading=!0,this.error="",fetch(`/aetheronepysocialplugin/analysis_for_key/${this.key}`).then((e=>e.json())).then((e=>{"success"===e.status&&Array.isArray(e.result.data)?this.sessions=e.result.data:(this.sessions=[],this.error=e.message||"No analyses found."),this.loading=!1})).catch((()=>{this.error="Failed to load analyses.",this.loading=!1}))}}};const ks=(0,p.A)(hs,[["render",us],["__scopeId","data-v-a995bf68"]]);var ys=ks;const vs={class:"keys-view"},ps={class:"breadcrumb-nav"},gs={class:"breadcrumb"},ms={key:0},Ls={key:1,class:"error"},fs={key:2},bs={class:"merged-block"},Cs={class:"key-list"},Es={class:"key-row-flex"},Ss={class:"key-details"},_s={class:"key-actions"},ws=["onClick"],Ks=["onClick"],Xs={key:0},Is=["onClick"],Ds={key:2},Ts={class:"modal"},Ms=["value"],xs={class:"modal-actions"},Fs={key:0,class:"error"},As={class:"modal"},Os={class:"modal-actions"},Ws={key:0,class:"error"},Us={class:"modal"},$s={class:"modal-actions"},js={key:0,class:"error"};function Ns(e,s,t,r,o,n){const d=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",vs,[(0,i.Lk)("nav",ps,[(0,i.Lk)("ul",gs,[(0,i.Lk)("li",null,[(0,i.bF)(d,{to:"/home"},{default:(0,i.k6)((()=>s[12]||(s[12]=[(0,i.eW)("Home")]))),_:1,__:[12]})]),s[13]||(s[13]=(0,i.Lk)("li",null,"Keys",-1))])]),s[32]||(s[32]=(0,i.Lk)("h1",null,"Key Management",-1)),o.loadingKeys?((0,i.uX)(),(0,i.CE)("div",ms,"Loading keys...")):o.error?((0,i.uX)(),(0,i.CE)("div",Ls,(0,a.v_)(o.error),1)):((0,i.uX)(),(0,i.CE)("div",fs,[(0,i.Lk)("button",{class:"create-key-btn",onClick:s[0]||(s[0]=e=>o.showCreateModal=!0)},"Create New Key"),(0,i.Lk)("div",bs,[s[22]||(s[22]=(0,i.Lk)("h2",null,"All Keys (Merged)",-1)),(0,i.Lk)("ul",Cs,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.mergedKeys,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.key,class:"key-item"},[(0,i.Lk)("div",Es,[(0,i.Lk)("div",Ss,[(0,i.Lk)("div",null,[s[14]||(s[14]=(0,i.Lk)("strong",null,"Key:",-1)),(0,i.eW)(" "+(0,a.v_)(e.key),1)]),e.local?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",null,[s[15]||(s[15]=(0,i.Lk)("strong",null,"Local Key ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.local.id),1)]),(0,i.Lk)("div",null,[s[16]||(s[16]=(0,i.Lk)("strong",null,"Created:",-1)),(0,i.eW)(" "+(0,a.v_)(e.local.created_at),1)]),(0,i.Lk)("div",null,[s[17]||(s[17]=(0,i.Lk)("strong",null,"Session ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.local.session_id),1)]),(0,i.Lk)("div",_s,[(0,i.Lk)("button",{onClick:s=>n.editKey(e.local)},"Edit",8,ws),(0,i.Lk)("button",{onClick:s=>n.deleteKey(e.local)},"Delete",8,Ks)])],64)):(0,i.Q3)("",!0),e.server?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",null,[s[18]||(s[18]=(0,i.Lk)("strong",null,"Server Key ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.id),1)]),(0,i.Lk)("div",null,[s[19]||(s[19]=(0,i.Lk)("strong",null,"User ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.user_id),1)]),(0,i.Lk)("div",null,[s[20]||(s[20]=(0,i.Lk)("strong",null,"Server Session ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.session_id||e.server.local_session_id),1)]),e.server.local_session_id?((0,i.uX)(),(0,i.CE)("div",Xs,[s[21]||(s[21]=(0,i.Lk)("strong",null,"Local Session ID:",-1)),(0,i.eW)(" "+(0,a.v_)(e.server.local_session_id),1)])):(0,i.Q3)("",!0)],64)):(0,i.Q3)("",!0),(0,i.Lk)("button",{onClick:s=>o.showMore[e.key]=!o.showMore[e.key]},(0,a.v_)(o.showMore[e.key]?"Hide":"View More"),9,Is),o.showMore[e.key]?((0,i.uX)(),(0,i.CE)("pre",Ds,(0,a.v_)(e),1)):(0,i.Q3)("",!0)])])])))),128))])])])),o.showCreateModal?((0,i.uX)(),(0,i.CE)("div",{key:3,class:"modal-overlay",onClick:s[4]||(s[4]=(0,l.D$)((e=>o.showCreateModal=!1),["self"]))},[(0,i.Lk)("div",Ts,[s[26]||(s[26]=(0,i.Lk)("h2",null,"Create New Key",-1)),(0,i.Lk)("form",{onSubmit:s[3]||(s[3]=(0,l.D$)(((...e)=>n.createKey&&n.createKey(...e)),["prevent"]))},[(0,i.Lk)("label",null,[s[24]||(s[24]=(0,i.eW)("Session: ")),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>o.newKeySessionId=e),required:""},[s[23]||(s[23]=(0,i.Lk)("option",{value:"",disabled:""},"Select a session",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.sessions,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,a.v_)(e.description||"Session "+e.id),9,Ms)))),128))],512),[[l.u1,o.newKeySessionId]])]),(0,i.Lk)("div",xs,[s[25]||(s[25]=(0,i.Lk)("button",{type:"submit"},"Create",-1)),(0,i.Lk)("button",{type:"button",onClick:s[2]||(s[2]=e=>o.showCreateModal=!1)},"Cancel")])],32),o.createError?((0,i.uX)(),(0,i.CE)("div",Fs,(0,a.v_)(o.createError),1)):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0),o.showEditModal?((0,i.uX)(),(0,i.CE)("div",{key:4,class:"modal-overlay",onClick:s[8]||(s[8]=(0,l.D$)(((...e)=>n.closeEditModal&&n.closeEditModal(...e)),["self"]))},[(0,i.Lk)("div",As,[s[29]||(s[29]=(0,i.Lk)("h2",null,"Edit Key",-1)),(0,i.Lk)("form",{onSubmit:s[7]||(s[7]=(0,l.D$)(((...e)=>n.updateKey&&n.updateKey(...e)),["prevent"]))},[(0,i.Lk)("label",null,[s[27]||(s[27]=(0,i.eW)("Key: ")),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>o.editKeyData.key=e),required:""},null,512),[[l.Jo,o.editKeyData.key]])]),(0,i.Lk)("div",Os,[s[28]||(s[28]=(0,i.Lk)("button",{type:"submit"},"Save",-1)),(0,i.Lk)("button",{type:"button",onClick:s[6]||(s[6]=(...e)=>n.closeEditModal&&n.closeEditModal(...e))},"Cancel")])],32),o.editError?((0,i.uX)(),(0,i.CE)("div",Ws,(0,a.v_)(o.editError),1)):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0),o.showDeleteModal?((0,i.uX)(),(0,i.CE)("div",{key:5,class:"modal-overlay",onClick:s[11]||(s[11]=(0,l.D$)(((...e)=>n.closeDeleteModal&&n.closeDeleteModal(...e)),["self"]))},[(0,i.Lk)("div",Us,[s[30]||(s[30]=(0,i.Lk)("h2",null,"Delete Key",-1)),s[31]||(s[31]=(0,i.Lk)("p",null,"Are you sure you want to delete this key?",-1)),(0,i.Lk)("div",$s,[(0,i.Lk)("button",{onClick:s[9]||(s[9]=(...e)=>n.confirmDeleteKey&&n.confirmDeleteKey(...e))},"Yes, Delete"),(0,i.Lk)("button",{onClick:s[10]||(s[10]=(...e)=>n.closeDeleteModal&&n.closeDeleteModal(...e))},"Cancel")]),o.deleteError?((0,i.uX)(),(0,i.CE)("div",js,(0,a.v_)(o.deleteError),1)):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0)])}var Qs={name:"KeysView",data(){return{localKeys:[],serverKeys:[],mergedKeys:[],loadingKeys:!0,error:"",showCreateModal:!1,newKeySessionId:"",createError:"",showEditModal:!1,editKeyData:{},editError:"",showDeleteModal:!1,deleteKeyData:null,deleteError:"",sessions:[],showMore:{}}},mounted(){this.fetchKeys(),this.fetchSessions()},methods:{fetchKeys(){this.loadingKeys=!0,this.error="",fetch("/aetheronepysocialplugin/user").then((e=>e.json())).then((e=>fetch(`/aetheronepysocialplugin/key/${e.server_user_id}`))).then((e=>e.json())).then((e=>{this.localKeys=e.data&&e.data.local?e.data.local:[],this.serverKeys=e.data&&e.data.server?e.data.server:[];const s={};for(const t of this.localKeys)t.key&&(s[t.key]={key:t.key,local:t});for(const t of this.serverKeys)t.key&&(s[t.key]?s[t.key].server=t:s[t.key]={key:t.key,server:t});this.mergedKeys=Object.values(s),this.loadingKeys=!1})).catch((()=>{this.error="Failed to load keys.",this.loadingKeys=!1}))},fetchSessions(){fetch("/aetheronepysocialplugin/sessions").then((e=>e.json())).then((e=>{this.sessions=e.sessions||[]})).catch((()=>{this.sessions=[]}))},createKey(){this.createError="",fetch("/aetheronepysocialplugin/key",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({local_session_id:this.newKeySessionId})}).then((e=>e.json())).then((e=>{"success"===e.status||"exists"===e.status?(this.showCreateModal=!1,this.newKeySessionId="",this.fetchKeys()):this.createError=e.message||"Failed to create key."})).catch((()=>{this.createError="Failed to create key."}))},editKey(e){this.editKeyData={...e},this.showEditModal=!0,this.editError=""},updateKey(){this.editError="",fetch(`/aetheronepysocialplugin/key/${this.editKeyData.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:this.editKeyData.key})}).then((e=>e.json())).then((e=>{"success"===e.status?(this.showEditModal=!1,this.fetchKeys()):this.editError=e.message||"Failed to update key."})).catch((()=>{this.editError="Failed to update key."}))},closeEditModal(){this.showEditModal=!1,this.editKeyData={}},deleteKey(e){this.deleteKeyData=e,this.showDeleteModal=!0,this.deleteError=""},confirmDeleteKey(){fetch(`/aetheronepysocialplugin/key/${this.deleteKeyData.id}`,{method:"DELETE"}).then((e=>e.json())).then((e=>{"success"===e.status?(this.showDeleteModal=!1,this.deleteKeyData=null,this.fetchKeys()):this.deleteError=e.message||"Failed to delete key."})).catch((()=>{this.deleteError="Failed to delete key."}))},closeDeleteModal(){this.showDeleteModal=!1,this.deleteKeyData=null}}};const Js=(0,p.A)(Qs,[["render",Ns],["__scopeId","data-v-ad740e9e"]]);var Vs=Js;const Ps=[{path:"/setup",component:R},{path:"/servers",component:R},{path:"/auth",component:ue},{path:"/home",component:K},{path:"/sessions",component:Te},{path:"/analysis",component:ss},{path:"/analysis/:key",component:ys},{path:"/keys",component:Vs},{path:"/",redirect:"/home"}],Rs=(0,C.aE)({history:(0,C.LA)("/aetheronepysocialplugin/"),routes:Ps});Rs.beforeEach(((e,s,t)=>{const l=localStorage.getItem("selectedServerId"),i=JSON.parse(localStorage.getItem("userTokens")||"{}"),r=l&&i[l];l||"/setup"===e.path||"/servers"===e.path?l&&!r&&"/auth"!==e.path&&"/setup"!==e.path&&"/servers"!==e.path?t("/auth"):l&&r&&"/auth"===e.path||l&&"/setup"===e.path?t("/home"):t():t("/setup")}));var qs=Rs;(0,l.Ef)(b).use(qs).mount("#app")}},s={};function t(l){var i=s[l];if(void 0!==i)return i.exports;var r=s[l]={exports:{}};return e[l].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(s,l,i,r){if(!l){var o=1/0;for(c=0;c<e.length;c++){l=e[c][0],i=e[c][1],r=e[c][2];for(var a=!0,n=0;n<l.length;n++)(!1&r||o>=r)&&Object.keys(t.O).every((function(e){return t.O[e](l[n])}))?l.splice(n--,1):(a=!1,r<o&&(o=r));if(a){e.splice(c--,1);var d=i();void 0!==d&&(s=d)}}return s}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[l,i,r]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var l in s)t.o(s,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:s[l]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){var e={524:0};t.O.j=function(s){return 0===e[s]};var s=function(s,l){var i,r,o=l[0],a=l[1],n=l[2],d=0;if(o.some((function(s){return 0!==e[s]}))){for(i in a)t.o(a,i)&&(t.m[i]=a[i]);if(n)var c=n(t)}for(s&&s(l);d<o.length;d++)r=o[d],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(c)},l=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];l.forEach(s.bind(null,0)),l.push=s.bind(null,l.push.bind(l))}();var l=t.O(void 0,[504],(function(){return t(8705)}));l=t.O(l)})();
//# sourceMappingURL=app.7ccaf2b0.js.map